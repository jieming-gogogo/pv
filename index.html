<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <!-- ★ 关键补丁开始：禁止缩放 + 输入框 16px -->
    <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover,user-scalable=no">
    <style>
        html,body{touch-action:manipulation}
        input,select{font-size:16px!important} /* 防止 iOS 强制放大 */
    </style>
    <!-- ★ 关键补丁结束 -->

    <meta charset="UTF-8">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <title>生物反应器搅拌功率与转速计算器</title>

    <!-- 下面是你原来的完整样式（未删减） -->
    <style>
        /* 基础样式 */
        *{margin:0;padding:0;box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif}
        body{background:linear-gradient(135deg,#1a2a6c,#2a4ab4,#1a2a6c);background-size:400% 400%;animation:gradientBG 15s ease infinite;color:#333;min-height:100vh;padding:20px}
        @keyframes gradientBG{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
        .container{max-width:800px;margin:0 auto;padding:20px}
        header{text-align:center;margin-bottom:30px;color:white;padding:25px;background:rgba(0,0,0,0.3);border-radius:15px;backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);box-shadow:0 8px 32px rgba(0,0,0,0.2)}
        h1{font-size:clamp(1.8rem,4vw,2.5rem);margin-bottom:10px;text-shadow:0 2px 4px rgba(0,0,0,0.5);display:flex;align-items:center;justify-content:center;gap:10px}
        .subtitle{font-size:clamp(.9rem,2vw,1.1rem);opacity:.9;max-width:700px;margin:0 auto}
        .calculator{background:rgba(255,255,255,.95);border-radius:15px;padding:30px;box-shadow:0 10px 30px rgba(0,0,0,.3);margin-bottom:30px}
        .section-title{font-size:clamp(1.5rem,3vw,1.8rem);margin-bottom:25px;color:#1a2a6c;display:flex;align-items:center;gap:10px;border-bottom:2px solid #1a2a6c;padding-bottom:10px}
        .form-group{margin-bottom:25px}
        label{display:block;margin-bottom:8px;font-weight:500;color:#444;font-size:clamp(1rem,2.5vw,1.1rem)}
        select,input{width:100%;padding:14px;border:2px solid #ddd;border-radius:10px;font-size:clamp(1rem,2.5vw,1.1rem);transition:all .3s;background:white}
        select:focus,input:focus{border-color:#1a2a6c;outline:none;box-shadow:0 0 0 3px rgba(26,42,108,.2)}
        .input-row{display:flex;flex-wrap:wrap;gap:20px;margin-bottom:15px}
        .input-box{flex:1;min-width:250px}
        .reactor-info{background:#e3f2fd;border-radius:10px;padding:15px;margin-top:10px;display:none}
        .info-row{display:flex;justify-content:space-between;padding:8px 0;border-bottom:1px solid #bbdefb;font-size:clamp(.9rem,2.5vw,1rem)}
        .info-row:last-child{border-bottom:none}
        .info-label{font-weight:600;color:#1a2a6c}
        .btn-group{display:flex;flex-wrap:wrap;gap:15px;margin-top:20px}
        button{flex:1;min-width:150px;padding:15px;border:none;border-radius:10px;font-size:clamp(1rem,2.5vw,1.1rem);font-weight:600;cursor:pointer;transition:all .3s}
        .btn-calculate{background:linear-gradient(to right,#1a2a6c,#2a4ab4);color:white}
        .btn-reset{background:linear-gradient(to right,#b21f1f,#d9534f);color:white}
        button:hover{transform:translateY(-2px);box-shadow:0 5px 15px rgba(0,0,0,.2)}
        .result{margin-top:25px;padding:20px;background:#e9f7fe;border-radius:10px;border-left:5px solid #1a2a6c}
        .result-title{font-size:clamp(1.2rem,2.5vw,1.3rem);margin-bottom:15px;color:#1a2a6c}
        .result-value{font-size:clamp(1.5rem,4vw,1.8rem);font-weight:700;color:#1a2a6c;text-align:center;margin:15px 0}
        .result-details{font-size:clamp(.9rem,2.5vw,1rem);color:#555;line-height:1.6}
        @media(max-width:768px){.container{padding:10px}header,.calculator{padding:20px}.input-box{min-width:100%}}
        @media(max-width:480px){.btn-group{flex-direction:column}button{width:100%}}
    </style>
</head>
<body>
    <!-- 微信提示层 -->
    <div id="wechat-warning">
        <div class="wechat-icon">⚠️</div>
        <h2>访问提示</h2>
        <p>检测到您在微信内访问本工具</p>
        <p>请点击右上角 <span style="color:#00ff00">···</span> 按钮</p>
        <p>选择 <strong style="color:#00ff00">"在浏览器打开"</strong></p>
        <button onclick="document.getElementById('wechat-warning').style.display='none'">我已用浏览器打开</button>
    </div>

    <!-- 页面内容 -->
    <div class="container">
        <header>
            <h1>🧪 生物反应器搅拌功率与转速计算器</h1>
            <p class="subtitle">输入反应器类型、体积和功率输入(P/V)或搅拌转速，计算另一个参数</p>
        </header>

        <div class="calculator">
            <h2>🧮 参数计算</h2>

            <label>反应器类型
                <select id="reactor-type">
                    <option value="">--请选择--</option>
                    <option value="GE-XDR500">GE-XDR500</option>
                    <option value="Hyclone-SUB100">Hyclone-SUB100</option>
                    <option value="Hyclone-SUB500">Hyclone-SUB500</option>
                    <option value="Sartorius-200">Sartorius-200</option>
                    <option value="Applikon-3L">Applikon-3L</option>
                    <option value="Applikon-15L">Applikon-15L</option>
                    <option value="Sartorius-50">Sartorius-50</option>
                    <option value="BBI-3L">BBI-3L</option>
                    <option value="GE-XDR50">GE-XDR50</option>
                    <option value="Sartorius-500">Sartorius-500</option>
                </select>
            </label>

            <label>反应体积 (L)<input type="number" id="volume" placeholder="例如 100" min="1" step="0.1"></label>

            <div class="input-row">
                <div class="input-box">
                    <label>功率输入 P/V (W/m³)<input type="number" id="pv" placeholder="留空则计算"></label>
                </div>
                <div class="input-box">
                    <label>搅拌转速 (RPM)<input type="number" id="rpm" placeholder="留空则计算"></label>
                </div>
            </div>

            <div class="btn-group">
                <button class="btn-calculate" onclick="calc()">📝 计算参数</button>
                <button class="btn-reset" onclick="reset()">🔄 重置输入</button>
            </div>

            <div class="result">
                <h3>📈 计算结果</h3>
                <div id="result-value">等待计算...</div>
                <div id="result-details">选择反应器类型并输入参数后，计算结果将显示在这里。</div>
            </div>
        </div>
    </div>

    <script>
        const data = {
            "GE-XDR500": {ne: 1.15, d: 0.2667},
            "Hyclone-SUB100": {ne: 2.1, d: 0.146},
            "Hyclone-SUB500": {ne: 2.1, d: 0.251},
            "Sartorius-200": {ne: 1.1, d: 0.225},
            "Applikon-3L": {ne: 1.5, d: 0.045},
            "Applikon-15L": {ne: 1.5, d: 0.075},
            "Sartorius-50": {ne: 1.4, d: 0.143},
            "BBI-3L": {ne: 0.7, d: 0.052},
            "GE-XDR50": {ne: 1.15, d: 0.21},
            "Sartorius-500": {ne: 1.3, d: 0.31}
        };
        const density = 1000;

        function calc() {
            const type = document.getElementById('reactor-type').value;
            const volume = parseFloat(document.getElementById('volume').value);
            const pv = parseFloat(document.getElementById('pv').value);
            const rpm = parseFloat(document.getElementById('rpm').value);
            const resVal = document.getElementById('result-value');
            const resDet = document.getElementById('result-details');

            if (!type || !volume) { resVal.textContent = '请选择反应器并输入体积'; return; }
            const {ne, d} = data[type];
            const V_m3 = volume / 1000;

            if (pv && !rpm) {
                const n = Math.pow(pv * V_m3 / (ne * density * Math.pow(d, 5)), 1/3);
                const rpmCalc = n * 60;
                document.getElementById('rpm').value = rpmCalc.toFixed(1);
                resVal.textContent = `${rpmCalc.toFixed(1)} RPM`;
                resDet.textContent = `根据 P/V = ${pv} W/m³ 和体积 ${volume} L 计算得出`;
            } else if (rpm && !pv) {
                const n = rpm / 60;
                const pvCalc = (ne * density * Math.pow(n, 3) * Math.pow(d, 5)) / V_m3;
                document.getElementById('pv').value = pvCalc.toFixed(2);
                resVal.textContent = `${pvCalc.toFixed(2)} W/m³`;
                resDet.textContent = `根据转速 ${rpm} RPM 和体积 ${volume} L 计算得出`;
            } else {
                resVal.textContent = '请只填 P/V 或转速其一';
            }
        }

        function reset() {
            [...document.querySelectorAll('#reactor-type,#volume,#pv,#rpm')].forEach(el => el.value = '');
            document.getElementById('result-value').textContent = '等待计算...';
            document.getElementById('result-details').textContent = '选择反应器类型并输入参数后，计算结果将显示在这里。';
        }
    </script>
</body>
</html>
